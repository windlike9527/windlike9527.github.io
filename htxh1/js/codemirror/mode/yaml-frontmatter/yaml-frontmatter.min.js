// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: https://codemirror.net/5/LICENSE
(function(c){"object"==typeof exports&&"object"==typeof module?c(require("../../lib/codemirror"),require("../yaml/yaml")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../yaml/yaml"],c):c(CodeMirror)})(function(c){c.defineMode("yaml-frontmatter",function(g,h){function e(a){return 1==a.state?{mode:d,state:a.yaml}:{mode:f,state:a.inner}}var d=c.getMode(g,"yaml"),f=c.getMode(g,h&&h.base||"gfm");return{startState:function(){return{state:0,yaml:null,inner:c.startState(f)}},copyState:function(a){return{state:a.state,yaml:a.yaml&&c.copyState(d,a.yaml),inner:c.copyState(f,a.inner)}},token:function(a,b){if(0==b.state){if(a.match("---",!1))return b.state=1,b.yaml=c.startState(d),d.token(a,b.yaml);b.state=2;return f.token(a,b.inner)}if(1==b.state){var e=a.sol()&&a.match(/(---|\.\.\.)/,!1);a=d.token(a,b.yaml);e&&(b.state=2,b.yaml=null);return a}return f.token(a,b.inner)},innerMode:e,indent:function(a,b,d){a=e(a);return a.mode.indent?a.mode.indent(a.state,b,d):c.Pass},blankLine:function(a){a=e(a);if(a.mode.blankLine)return a.mode.blankLine(a.state)}}})});